<!--
  ~ Copyright 2021 The PartChain Authors. All Rights Reserved.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!--ACL DETAIL-->
<div class="acl-detail-card" *ngIf="this.acl">
  <div class="acl-detail-header">
    <!--Acl header-->
    <p class="text-xl large-text" *ngIf="this.acl.entities; else noEntity">
      {{ this.getTargetOrg(this.acl.entities, this.owner) }}
    </p>

    <ng-template #noEntity>
      <span>Changed by {{ this.acl.changedBy }}</span>
    </ng-template>

    <a *ngIf="this.type" (click)="this.emitEvent($event)"><p>View history</p></a>
  </div>
  <mat-divider></mat-divider>
  <div class="acl-detail-content">
    <!--Acl ID-->
    <section *ngIf="this.acl.entities">
      <p class="small-text text-dustyGray">ID</p>
      <p class="large-text">{{ this.getId(this.acl.entities) }}</p>
    </section>
    <!--Acl created date-->
    <section>
      <p class="small-text text-dustyGray">Created date</p>
      <p class="large-text">{{ this.acl.timestamp }}</p>
    </section>
    <!--Acl Created status-->
    <section>
      <p class="small-text text-dustyGray">Status</p>
      <div class="acl-detail-status">
        <svg height="13" width="13">
          <circle
            *ngIf="this.type === 'active' || this.acl.status.toLowerCase() === 'active'; else pending"
            cx="5.5"
            cy="5.5"
            r="5.5"
            [ngStyle]="{ fill: '#0BB759' }"
          />
          <ng-template #pending>
            <circle
              *ngIf="this.type === 'pending' || this.acl.status.toLowerCase() === 'pending'; else inactive"
              cx="5.5"
              cy="5.5"
              r="5.5"
              [ngStyle]="{ fill: '#FFAD1F' }"
            />
          </ng-template>
          <ng-template #inactive>
            <circle
              *ngIf="this.type === 'inactive' || this.acl.status.toLowerCase() === 'inactive'"
              cx="5.5"
              cy="5.5"
              r="5.5"
              [ngStyle]="{ fill: '#D8D8D8' }"
            />
          </ng-template>
        </svg>
        <p class="ml-2 large-text" *ngIf="this.type; else status">{{ this.firstLetterToUpperCase(this.type) }}</p>
        <ng-template #status>
          <p class="ml-2 large-text">{{ this.firstLetterToUpperCase(this.acl.status) }}</p>
        </ng-template>
      </div>
    </section>
    <!--Acl comment-->
    <section *ngIf="this.acl.comment">
      <p class="small-text text-dustyGray">Comment</p>
      <div class="acl-detail-comment">
        <p class="large-text">{{ this.acl.comment }}</p>
      </div>
    </section>
    <!--Acl submit section-->
    <ng-container *ngIf="this.type === 'pending' && this.acl.changedBy !== this.owner">
      <section class="acl-detail-btn-section">
        <p class="regular-text text-tundoraShadeNobel col-span-8">*Changed by {{ this.acl.changedBy }}</p>
        <app-button class="col-span-2" [type]="'submit'" [button]="'secondary'" (clickEvent)="this.denyAccess()"
          >Deny Access</app-button
        >
        <app-button class="col-span-2" [type]="'submit'" [button]="'primary'" (clickEvent)="this.acceptAccess()"
          >Accept Access</app-button
        >
      </section>
    </ng-container>

    <ng-container *ngIf="this.type === 'pending' && this.acl.changedBy === this.owner">
      <section>
        <p class="regular-text text-tundoraShadeNobel">*Changed by {{ this.acl.changedBy }}</p>
        <div class="acl-detail-waiting-for-acceptance">
          <svg-icon key="information-line" class="text-primary"></svg-icon>
          <p class="regular-text ml-2 mt-0.5">
            Waiting for
            {{ this.getTargetOrg(this.acl.entities, this.acl.changedBy) }}
            acceptance
          </p>
        </div>
      </section>
    </ng-container>

    <ng-container *ngIf="this.type === 'active'">
      <section class="acl-detail-btn-section">
        <p class="regular-text text-tundoraShadeNobel col-span-10">*Changed by {{ this.acl.changedBy }}</p>
        <app-button class="col-span-2" [type]="'submit'" [button]="'primary'" (clickEvent)="this.removeAccess()"
          >Remove Access</app-button
        >
      </section>
    </ng-container>

    <ng-container *ngIf="this.type === 'inactive'">
      <section class="acl-detail-btn-section">
        <p class="regular-text text-tundoraShadeNobel col-span-10">*Changed by {{ this.acl.changedBy }}</p>
        <app-button class="col-span-2" [type]="'submit'" [button]="'primary'" (clickEvent)="this.openModal('update')"
          >Update Access</app-button
        >
      </section>
    </ng-container>
  </div>
</div>
