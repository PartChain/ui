<!--
  ~ Copyright 2021 The PartChain Authors. All Rights Reserved.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!--ASSET FILTER-->
<header class="asset-filter-header">
  <h4 class="align-middle">{{ this.title }} list filter</h4>
  <svg-icon key="close-fill" size="sm" class="text-tundora cursor-pointer mt-1" (click)="dialogClose()"> </svg-icon>
</header>
<mat-divider class="asset-filter-divider"></mat-divider>
<div class="asset-filter-container">
  <form [formGroup]="this.filterForm" (keydown.enter)="this.filterAssets($event)">
    <mat-accordion>
      <!--Asset filter customer serial number-->
      <mat-expansion-panel *ngIf="this.filterForm.get('serialNumberCustomer')">
        <mat-expansion-panel-header>
          <mat-panel-title class="regular-text">
            Customer serial number
          </mat-panel-title>
          <mat-panel-description class="tx-ok" *ngIf="this.filterForm.get('serialNumberCustomer').value.length > 0">
            <svg-icon key="check-fill" size="xs" class="text-primary cursor-pointer"></svg-icon>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-form-field>
          <input matInput formControlName="serialNumberCustomer" />
          <mat-hint>Ex: WBAFG01080L328038</mat-hint>
        </mat-form-field>
      </mat-expansion-panel>
      <!--Asset filter serial number type-->
      <mat-expansion-panel *ngIf="this.filterForm.get('serialNumberType')">
        <mat-expansion-panel-header>
          <mat-panel-title class="regular-text">
            Serial number type
          </mat-panel-title>
          <mat-panel-description class="tx-ok" *ngIf="this.filterForm.get('serialNumberType').value.length > 0">
            <svg-icon key="check-fill" size="xs" class="text-primary cursor-pointer"></svg-icon>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-radio-group
          aria-label="Select an option"
          formControlName="serialNumberType"
          class="asset-filter-serial-number-type-option"
          required
        >
          <mat-radio-button *ngFor="let type of this.serialNumberType" [value]="type">{{ type }} </mat-radio-button>
        </mat-radio-group>
      </mat-expansion-panel>
      <!--Asset filter part name/number-->
      <mat-expansion-panel *ngIf="this.filterForm.get('partNameNumber')">
        <mat-expansion-panel-header>
          <mat-panel-title class="regular-text">
            Part name or number
          </mat-panel-title>
          <mat-panel-description class="tx-ok" *ngIf="this.filterForm.get('partNameNumber').value.length > 0">
            <svg-icon key="check-fill" size="xs" class="text-primary cursor-pointer"></svg-icon>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-form-field>
          <input matInput formControlName="partNameNumber" />
          <mat-hint>Ex: BMW 8-Series</mat-hint>
        </mat-form-field>
      </mat-expansion-panel>
      <!--Asset filter manufacturer name-->
      <mat-expansion-panel *ngIf="this.filterForm.get('manufacturer')">
        <mat-expansion-panel-header>
          <mat-panel-title class="regular-text">
            Manufacturer name
          </mat-panel-title>
          <mat-panel-description class="tx-ok" *ngIf="this.filterForm.get('manufacturer').value.length > 0">
            <svg-icon key="check-fill" size="xs" class="text-primary cursor-pointer"></svg-icon>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-form-field>
          <input matInput formControlName="manufacturer" />
          <mat-hint>Ex: BWM</mat-hint>
        </mat-form-field>
      </mat-expansion-panel>
      <!--Asset filter manufacturer plant-->
      <mat-expansion-panel *ngIf="this.filterForm.get('manufacturerPlant')">
        <mat-expansion-panel-header>
          <mat-panel-title class="regular-text">
            Manufacturer Plant
          </mat-panel-title>
          <mat-panel-description class="tx-ok" *ngIf="this.filterForm.get('manufacturerPlant').value.length > 0">
            <svg-icon key="check-fill" size="xs" class="text-primary cursor-pointer"></svg-icon>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-form-field>
          <input matInput formControlName="manufacturerPlant" />
          <mat-hint>Ex: Dingolfing</mat-hint>
        </mat-form-field>
      </mat-expansion-panel>
      <!--Asset filter manufacturer line-->
      <mat-expansion-panel *ngIf="this.filterForm.get('manufacturerLine')">
        <mat-expansion-panel-header>
          <mat-panel-title class="regular-text">
            Manufacturer Line
          </mat-panel-title>
          <mat-panel-description class="tx-ok" *ngIf="this.filterForm.get('manufacturerLine').value.length > 0">
            <svg-icon key="check-fill" size="xs" class="text-primary cursor-pointer"></svg-icon>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-form-field>
          <input matInput formControlName="manufacturerLine" />
          <mat-hint>Ex: Production line</mat-hint>
        </mat-form-field>
      </mat-expansion-panel>
      <!--Asset filter production country code-->
      <mat-expansion-panel *ngIf="this.filterForm.get('productionCountryCode')">
        <mat-expansion-panel-header>
          <mat-panel-title class="regular-text">
            Production country code
          </mat-panel-title>
          <mat-panel-description class="tx-ok" *ngIf="this.filterForm.get('productionCountryCode').value.length > 0">
            <svg-icon key="check-fill" size="xs" class="text-primary cursor-pointer"></svg-icon>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-form-field>
          <input matInput formControlName="productionCountryCode" />
          <mat-hint>Ex: DE</mat-hint>
        </mat-form-field>
      </mat-expansion-panel>
      <!--Asset filter production date-->
      <mat-expansion-panel *ngIf="this.filterForm.get('productionDateFrom') && this.filterForm.get('productionDateTo')">
        <mat-expansion-panel-header>
          <mat-panel-title class="regular-text">
            Production date
          </mat-panel-title>
          <mat-panel-description class="tx-ok" *ngIf="!this.isDefaultProductionDateRange()">
            <svg-icon key="check-fill" size="xs" class="text-primary cursor-pointer"></svg-icon>
          </mat-panel-description>
        </mat-expansion-panel-header>

        <div class="flex flex-row">
          <mat-form-field class="mr-4">
            <input
              matInput
              [ngxMatDatetimePicker]="productionDateFrom"
              placeholder="Start of period *"
              formControlName="productionDateFrom"
              [max]="this.today"
            />
            <mat-datepicker-toggle matSuffix [for]="productionDateFrom"> </mat-datepicker-toggle>
            <ngx-mat-datetime-picker #productionDateFrom [showSeconds]="true"> </ngx-mat-datetime-picker>
          </mat-form-field>
          <mat-form-field>
            <input
              matInput
              [ngxMatDatetimePicker]="productionDateTo"
              placeholder="End of period"
              formControlName="productionDateTo"
            />
            <mat-datepicker-toggle matSuffix [for]="productionDateTo"> </mat-datepicker-toggle>
            <ngx-mat-datetime-picker #productionDateTo [showSeconds]="true"> </ngx-mat-datetime-picker>
          </mat-form-field>
        </div>
      </mat-expansion-panel>
      <!--Asset filter quality status-->
      <mat-expansion-panel *ngIf="this.filterForm.get('qualityStatus')">
        <mat-expansion-panel-header>
          <mat-panel-title class="regular-text">
            Quality status
          </mat-panel-title>
          <mat-panel-description class="tx-ok" *ngIf="this.filterForm.get('qualityStatus').value !== 'all'">
            <svg-icon key="check-fill" size="xs" class="text-primary cursor-pointer"></svg-icon>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-button-toggle-group formControlName="qualityStatus" aria-label="Asset status">
          <mat-button-toggle value="all">ALL</mat-button-toggle>
          <mat-button-toggle value="OK">OK</mat-button-toggle>
          <mat-button-toggle value="FLAG">FLAG</mat-button-toggle>
          <mat-button-toggle value="NOK">NOK</mat-button-toggle>
        </mat-button-toggle-group>
      </mat-expansion-panel>
    </mat-accordion>
    <mat-error class="regular-text" *ngIf="this.filterForm.get('productionDateFrom').value === ''"
      >Please specify a start period</mat-error
    >
    <!--Asset filter controls-->
    <section class="grid grid-cols-10 gap-2 mt-2 p-2">
      <app-button
        class="col-start-7 col-span-2"
        [type]="'submit'"
        [button]="'secondary'"
        (clickEvent)="this.clearFilters()"
        >Clear</app-button
      >
      <app-button
        class="col-start-9 col-span-2"
        [type]="'submit'"
        [button]="'primary'"
        (clickEvent)="this.filterAssets($event)"
        >Apply</app-button
      >
    </section>
  </form>
</div>
